<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Competency Dictionary | Talent Tree Labs</title>
    <link rel="icon" type="image/png" href="assets/TTL-Logo.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Oxanium:wght@500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 
                            indigo: '#0B0B15',      
                            slate: '#48466D',       
                            light: '#6F6D91',
                            accent: '#7C3AED',
                            surface: '#1A1A2E',     
                            white: '#F4F4F7', 
                        }
                    },
                    fontFamily: { 
                        sans: ['Inter', 'sans-serif'], 
                        display: ['Oxanium', 'sans-serif'] 
                    },
                    backgroundImage: {
                        'glow-gradient': 'radial-gradient(circle at 50% 0%, rgba(72, 70, 109, 0.2) 0%, rgba(30, 30, 52, 0) 70%)',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(-10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    },
                    animation: {
                        fadeIn: 'fadeIn 0.3s ease-out forwards',
                    }
                }
            }
        }
    </script>

    <style>
        body { 
            background-color: #0B0B15; 
            color: #E2E8F0; 
            overflow-x: hidden; 
        }
        
        /* FIXED GRID LOGIC */
        .bg-tech-grid {
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            mask-image: linear-gradient(to bottom, rgba(0,0,0,1) 85%, rgba(0,0,0,0));
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        /* Mobile Menu Glass */
        .glass-panel-mobile {
            background: rgba(11, 11, 21, 0.95); 
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-card {
            background: linear-gradient(180deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            background: rgba(72, 70, 109, 0.1);
            border-color: rgba(124, 58, 237, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px -10px rgba(124, 58, 237, 0.2);
        }
        
        /* Sidebar Active State */
        .sidebar-btn-active {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border-left: 2px solid #7C3AED; 
        }

        /* Scroll Animation Classes */
        .fade-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .fade-on-scroll.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #0B0B15; }
        ::-webkit-scrollbar-thumb { background: #48466D; border-radius: 3px; }
    </style>
</head>
<body class="antialiased font-sans relative min-h-screen flex flex-col">

    <!-- FIXED GRID LAYER -->
    <div class="fixed inset-0 z-[-1] bg-tech-grid pointer-events-none w-full h-full"></div>

    <!-- NAV -->
    <nav class="fixed w-full z-50 glass-panel border-b-0 border-b border-white/5">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center relative">
            <a href="index.html" class="block hover:opacity-80 transition flex-shrink-0">
                <img src="assets/TTL-Logo.png" alt="Talent Tree Labs" class="h-12 md:h-16 w-auto"> 
            </a>
            
            <!-- Desktop Menu -->
            <div class="hidden md:flex items-center space-x-8">
                <a href="index.html" class="text-sm font-medium text-gray-400 hover:text-white transition-colors">Talent Tree Labs</a>
                <a href="dictionary.html" class="text-sm font-medium text-gray-400 hover:text-white transition-colors">Competency Dictionary</a>
                <a href="consultants.html" class="text-sm font-medium text-gray-400 hover:text-white transition-colors">Our Consultants</a>
                <a href="consultation.html" class="px-5 py-2 bg-brand-slate hover:bg-brand-accent text-white text-sm font-bold rounded transition-all shadow-[0_0_15px_rgba(72,70,109,0.4)] hover:shadow-[0_0_25px_rgba(124,58,237,0.6)]">
                    Book Consultation
                </a>
            </div>

            <!-- Mobile Hamburger -->
            <div class="md:hidden">
                <button id="mobile-menu-btn" class="text-gray-300 hover:text-white focus:outline-none p-2">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
            </div>

            <!-- Mobile Dropdown -->
            <div id="mobile-menu" class="hidden absolute top-full left-0 w-full glass-panel-mobile shadow-2xl flex-col p-6 space-y-4 md:hidden animate-fadeIn">
                <a href="index.html" class="block text-base font-medium text-white border-b border-white/5 pb-2">Talent Tree Labs</a>
                <a href="dictionary.html" class="block text-base font-medium text-gray-400 hover:text-white border-b border-white/5 pb-2">Competency Dictionary</a>
                <a href="consultants.html" class="block text-base font-medium text-gray-400 hover:text-white border-b border-white/5 pb-2">Our Consultants</a>
                <a href="consultation.html" class="block w-full text-center px-5 py-3 bg-brand-slate text-white font-bold rounded shadow-lg mt-4">Book Consultation</a>
            </div>
        </div>
    </nav>

    <!-- TOP EXPLAINER -->
    <header class="pt-28 md:pt-32 pb-8 md:pb-12 relative z-10 border-b border-white/5">
        <div class="absolute top-0 left-0 w-full h-full bg-glow-gradient pointer-events-none"></div>
        <div class="container mx-auto px-6 fade-on-scroll">
            <div class="glass-panel p-6 md:p-10 rounded-xl bg-brand-indigo/50 border border-brand-slate/30 shadow-2xl max-w-5xl mx-auto">
                <div class="max-w-3xl">
                    <h1 class="font-display text-3xl md:text-5xl font-bold text-white mb-4">The DNA of a High-Performance Organization.</h1>
                    <p class="text-base md:text-lg text-gray-300 leading-relaxed mb-8">
                        This dictionary maps the skills, behaviors, and standards that define success in the gaming and esports industry. It is the foundational data layer for all modern HR tools.
                    </p>
                </div>

                <!-- Value Props Grid -->
                <div class="grid md:grid-cols-3 gap-6 border-t border-white/10 pt-8">
                    <div>
                        <h4 class="text-brand-accent font-bold text-sm uppercase tracking-wider mb-2 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                            Recruitment
                        </h4>
                        <p class="text-sm text-gray-400">Derive precise job descriptions and structured interview guides.</p>
                    </div>
                    <!-- RESTORED: Removed 'hidden md:block' -->
                    <div>
                        <h4 class="text-brand-accent font-bold text-sm uppercase tracking-wider mb-2 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                            Performance
                        </h4>
                        <p class="text-sm text-gray-400">Build fair scorecards and objective career progression paths.</p>
                    </div>
                    <!-- RESTORED: Removed 'hidden md:block' -->
                    <div>
                        <h4 class="text-brand-accent font-bold text-sm uppercase tracking-wider mb-2 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                            Strategy
                        </h4>
                        <p class="text-sm text-gray-400">Identify skill gaps and design targeted training interventions.</p>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT AREA -->
    <div class="container mx-auto px-6 py-8 md:py-12 relative z-10 flex-1 flex flex-col md:flex-row gap-8 md:gap-12">
        
        <!-- SIDEBAR -->
        <!-- Mobile: Horizontal Scroll / Desktop: Sticky Left -->
        <aside class="w-full md:w-72 flex-shrink-0">
            <div class="md:sticky md:top-28">
                <h3 class="text-xs font-bold text-brand-accent uppercase tracking-widest mb-4 pl-2">Competency Domains</h3>
                
                <!-- Container modified for mobile scrolling -->
                <div id="domain-list" class="flex overflow-x-auto space-x-4 md:block md:space-x-0 md:space-y-2 glass-panel p-2 md:p-4 rounded-lg border border-white/5 pb-4 md:pb-4">
                    <!-- Domains injected via JS -->
                </div>
                
                <div class="mt-4 md:mt-8 p-4 bg-brand-indigo/50 rounded border border-brand-slate/40 text-sm text-gray-400 fade-on-scroll hidden md:block">
                    <span class="text-brand-accent font-bold">Tip:</span> Select a cluster to expand its competencies.
                </div>
            </div>
        </aside>

        <!-- CONTENT -->
        <main class="flex-1 min-w-0">
            <div class="mb-8 pb-4 border-b border-white/10 fade-on-scroll">
                <h1 id="page-title" class="font-display text-3xl md:text-4xl font-bold text-white mb-2">Select a Domain</h1>
                <p class="text-gray-400 text-sm md:text-base">Explore the specific skills and behaviors required for this sector.</p>
            </div>
            
            <div id="content-area" class="space-y-16 pb-24 min-h-[500px]">
                <!-- Clusters injected here -->
                <div class="text-center py-20 opacity-50">
                    <p class="font-display text-xl text-gray-500">Loading competency data...</p>
                </div>
            </div>
        </main>
    </div>

    <!-- MODAL -->
    <div id="modal" class="fixed inset-0 z-[100] hidden">
        <div class="absolute inset-0 bg-[#0B0B15]/90 backdrop-blur-md" onclick="closeModal()"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4">
            <div class="glass-panel w-full max-w-5xl max-h-[90vh] overflow-y-auto rounded-xl shadow-2xl relative bg-[#0B0B15] border border-white/10 animate-[fadeIn_0.3s_ease-out]">
                <div class="p-6 md:p-12">
                    <button onclick="closeModal()" class="absolute top-6 right-6 text-gray-500 hover:text-white transition text-xl">âœ•</button>
                    
                    <h2 id="modal-title" class="font-display text-2xl md:text-3xl font-bold text-white mb-6 pr-8">Title</h2>
                    
                    <div class="bg-brand-slate/10 p-6 rounded-lg border border-brand-slate/20 mb-10">
                        <h4 class="text-xs font-bold text-brand-accent uppercase tracking-wider mb-2">Definition</h4>
                        <p id="modal-def" class="text-gray-200 italic font-serif text-base md:text-lg leading-relaxed">Definition...</p>
                    </div>
                    
                    <div id="modal-grid" class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <!-- Levels injected here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="bg-[#05050a] py-12 border-t border-white/5 z-10 relative">
        <div class="container mx-auto px-6 text-center">
            <p class="text-gray-600 text-sm">&copy; 2025 Talent Tree Labs. Built for the long game.</p>
        </div>
    </footer>

    <!-- LOAD DATA -->
    <script src="competencies.js"></script> 
    
    <!-- APP LOGIC -->
    <script>
        // DOM Elements
        const domainList = document.getElementById('domain-list');
        const contentArea = document.getElementById('content-area');
        const pageTitle = document.getElementById('page-title');
        const modal = document.getElementById('modal');

        document.addEventListener('DOMContentLoaded', () => {
            // 1. Mobile Menu Logic
            const mobileBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            if(mobileBtn && mobileMenu) {
                mobileBtn.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                    mobileMenu.classList.toggle('flex');
                });
            }

            // 2. Scroll Observer
            const observerOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
            const scrollObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.fade-on-scroll').forEach(el => scrollObserver.observe(el));

            if (typeof COMPETENCY_DATA === 'undefined') {
                contentArea.innerHTML = '<p class="text-red-400 font-mono">Error: competencies.js not found.</p>';
                return;
            }
            renderSidebar();
            const firstDomain = Object.keys(COMPETENCY_DATA)[0];
            loadDomain(firstDomain);
        });

        function renderSidebar() {
            Object.keys(COMPETENCY_DATA).forEach((domain, index) => {
                const btn = document.createElement('button');
                // Updated Classes for Mobile Compatibility (Whitespace nowrap for scrolling)
                btn.className = "w-auto md:w-full text-left px-4 py-2 md:py-3 rounded-lg text-sm font-medium text-gray-400 hover:bg-white/5 hover:text-white transition-all duration-200 whitespace-nowrap flex-shrink-0 border border-white/5 md:border-0 bg-white/5 md:bg-transparent";
                btn.innerText = domain;
                btn.onclick = (e) => {
                    document.querySelectorAll('#domain-list button').forEach(b => {
                        b.classList.remove('sidebar-btn-active', 'text-white', 'border-brand-accent');
                        b.classList.add('text-gray-400');
                    });
                    e.target.classList.remove('text-gray-400');
                    e.target.classList.add('sidebar-btn-active', 'text-white');
                    loadDomain(domain);
                };
                domainList.appendChild(btn);
                
                if (index === 0) {
                    btn.classList.remove('text-gray-400');
                    btn.classList.add('sidebar-btn-active', 'text-white');
                }
            });
        }

        function loadDomain(domain) {
            pageTitle.innerText = domain;
            contentArea.innerHTML = ''; 
            
            const clusters = COMPETENCY_DATA[domain];
            const sortedClusters = Object.entries(clusters).sort((a, b) => {
                const aHasRubric = a[1].some(comp => comp.rubric !== undefined);
                const bHasRubric = b[1].some(comp => comp.rubric !== undefined);
                if (bHasRubric && !aHasRubric) return 1;
                if (aHasRubric && !bHasRubric) return -1;
                return 0;
            });
            
            const dynamicObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('visible');
                });
            }, { root: null, rootMargin: '0px', threshold: 0.1 });

            const listWrapper = document.createElement('div');
            listWrapper.className = "space-y-4"; 

            sortedClusters.forEach(([clusterName, comps], index) => {
                const item = document.createElement('div');
                item.className = "fade-on-scroll border border-white/10 rounded-xl overflow-hidden bg-white/5 transition-all duration-300"; 
                
                const headerBtn = document.createElement('button');
                headerBtn.className = "w-full flex items-center justify-between p-6 text-left hover:bg-white/5 transition-colors group select-none";
                headerBtn.innerHTML = `
                    <h3 class="font-display text-lg md:text-2xl font-bold text-white group-hover:text-brand-accent transition-colors border-l-4 border-brand-slate pl-4">${clusterName}</h3>
                    <span class="transform transition-transform duration-300 text-gray-400 group-hover:text-white">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </span>
                `;

                const contentContainer = document.createElement('div');
                contentContainer.className = "hidden bg-black/20 p-6 border-t border-white/5";
                
                const grid = document.createElement('div');
                grid.className = "grid md:grid-cols-2 gap-5";

                comps.forEach(comp => {
                    const card = document.createElement('div');
                    const hasRubric = comp.rubric !== undefined;
                    card.className = `glass-card p-6 rounded-lg relative group ${hasRubric ? 'cursor-pointer' : 'opacity-60 cursor-default'}`;
                    
                    let html = `<h4 class="font-bold text-gray-100 text-base mb-2 group-hover:text-brand-accent transition">${comp.title}</h4>`;
                    
                    if (hasRubric) {
                        html += `<div class="flex items-center gap-2 mt-4">
                                    <span class="px-2 py-1 rounded bg-emerald-500/10 text-emerald-400 text-[10px] font-bold uppercase tracking-wider border border-emerald-500/20">Rubric Available</span>
                                 </div>`;
                    } else {
                        html += `<p class="text-xs text-gray-500 mt-3 italic">Definition pending</p>`;
                    }
                    
                    card.innerHTML = html;
                    if (hasRubric) card.onclick = (e) => { e.stopPropagation(); openModal(comp); }; 
                    grid.appendChild(card);
                });

                contentContainer.appendChild(grid);
                
                headerBtn.onclick = () => {
                    const isHidden = contentContainer.classList.contains('hidden');
                    const icon = headerBtn.querySelector('svg');
                    
                    if (isHidden) {
                        contentContainer.classList.remove('hidden');
                        contentContainer.classList.add('animate-fadeIn');
                        icon.style.transform = 'rotate(180deg)';
                        headerBtn.classList.add('bg-white/5'); 
                    } else {
                        contentContainer.classList.add('hidden');
                        contentContainer.classList.remove('animate-fadeIn');
                        icon.style.transform = 'rotate(0deg)';
                        headerBtn.classList.remove('bg-white/5');
                    }
                };

                item.appendChild(headerBtn);
                item.appendChild(contentContainer);
                listWrapper.appendChild(item);
                dynamicObserver.observe(item);
            });

            contentArea.appendChild(listWrapper);
        }

        function openModal(comp) {
            document.getElementById('modal-title').innerText = comp.title;
            document.getElementById('modal-def').innerText = comp.definition || "No definition available.";
            
            const grid = document.getElementById('modal-grid');
            grid.innerHTML = '';

            if (comp.rubric) {
                Object.keys(comp.rubric).forEach((level, index) => {
                    const col = document.createElement('div');
                    const headerColors = ['text-gray-400', 'text-blue-400', 'text-indigo-400', 'text-purple-400'];
                    
                    let html = `<div class="p-5 rounded-lg bg-white/5 border border-white/5 h-full hover:bg-white/10 transition duration-300">`;
                    html += `<h5 class="font-bold ${headerColors[index]} border-b border-white/10 pb-3 mb-4 text-sm uppercase tracking-widest">${level}</h5>`;
                    html += `<ul class="space-y-3">`;
                    comp.rubric[level].forEach(item => {
                        html += `<li class="text-sm text-gray-300 leading-relaxed flex gap-3"><span class="text-brand-slate mt-1.5 w-1.5 h-1.5 rounded-full bg-brand-slate flex-shrink-0"></span> <span>${item}</span></li>`;
                    });
                    html += `</ul></div>`;
                    
                    col.innerHTML = html;
                    grid.appendChild(col);
                });
            }
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; 
        }

        function closeModal() {
            modal.classList.add('hidden');
            document.body.style.overflow = ''; 
        }
    </script>
</body>
</html>
